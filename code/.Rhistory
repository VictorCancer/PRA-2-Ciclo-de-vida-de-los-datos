knitr::opts_chunk$set(echo = TRUE)
full$Age[match( full_imp$PassengerId, full$PassengerId)] <- full_imp$Age[match( full_imp$PassengerId, full$PassengerId)]
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(corrplot)
library(faraway)
library(ggfortify)
library(ResourceSelection)
library(pROC)
library(grid)
library(colorspace)
library(Rcpp)
library(vctrs)
library(VIM)
train <- read.table(file="train.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(train)
test <- read.table(file="test.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(test)
full <- rbind(test,train[-which(names(train) == "Survived")])
full[full$Embarked == "",]
ggplot(full[full$Embarked != "" & full$Pclass == "1",],aes(x=Embarked,y=Fare, fill=Embarked)) + geom_boxplot()+
theme(legend.position="none") + geom_hline(aes(yintercept=80), colour='yellow', linetype='dashed', lwd=2)
full[full$Embarked=="",]$Embarked <- "C"
train[train$Embarked=="",]$Embarked <- "C"
full[is.na(full$Fare),]
ggplot(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,], aes(x=Fare)) +
geom_density(color="darkblue", fill="lightblue",size=1)+ylab("Densidad")+xlab("Precio del pasaje") +
geom_vline(xintercept = median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare),color="red",size=1.1,linetype="dashed") +
geom_vline(xintercept = mean(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare),color="green",size=1.1,linetype="dashed") +
annotate(geom = "text", label = c("Mediana", "Media"), x = c(median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare), mean(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)), y = c(0.05, 0.05), angle = 90, vjust = 1)
fare_median <-  median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)
full[is.na(full$Fare),]$Fare <- fare_median
test[is.na(test$Fare),]$Fare <- fare_median
full_imp <- kNN(full,k=11,dist_var=c('Sex','Pclass','SibSp','Fare','Parch','Embarked'),variable='Age')
ggplot() +
geom_density(data=full_imp, aes(x=Age,color='Imputado') , size=1) +
geom_density(data=full, aes(x=Age, color = 'No imputado') ,size=1) +
geom_vline(xintercept = median(full$Age,na.rm = TRUE),color="blue",size=1.1,linetype="dashed") +
geom_vline(xintercept = median(full_imp$Age),color="red",size=1.1,linetype="dashed") +
ylab("Frecuencia") + xlab("Edad") + theme(legend.position = 'right') +
scale_color_manual("DataSet",values = c('Imputado' = 'red', 'No imputado' = 'blue'))
full$Age[match( full_imp$PassengerId, full$PassengerId)] <- full_imp$Age[match( full_imp$PassengerId, full$PassengerId)]
train$Age[match( full_imp$PassengerId, train$PassengerId)] <- full_imp$Age[match( full_imp$PassengerId, full$PassengerId)]
full$Age[match( full_imp$PassengerId, full$PassengerId)] <- full_imp$Age[match( full_imp$PassengerId, full$PassengerId)]
train$Age[match( full_imp$PassengerId, train$PassengerId)] <- full_imp$Age[match( full_imp$PassengerId, train$PassengerId)]
full_imp$Age[match( full_imp$PassengerId, train$PassengerId)]
full_imp$Age[match( full_imp$PassengerId, full$PassengerId)]
train_imp <- merge(train, full_imp[c('PassengerId','Age')], by.x=c("PassengerId"), by.y=c("PassengerId"), all.x=TRUE)
head(train_imp)
library(tidyverse)
install.packages(tidyverse)
install.packages("tidyverse")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(corrplot)
library(faraway)
library(ggfortify)
library(ResourceSelection)
library(pROC)
library(grid)
library(colorspace)
library(Rcpp)
library(vctrs)
library(tidyverse)
install.packages("tidyverse")
install.packages("tidyverse")
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(corrplot)
library(faraway)
library(ggfortify)
library(ResourceSelection)
library(pROC)
library(grid)
library(colorspace)
library(Rcpp)
library(vctrs)
library(tidyverse)
library(VIM)
train <- read.table(file="train.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(train)
test <- read.table(file="test.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(test)
full <- rbind(test,train[-which(names(train) == "Survived")])
full[full$Embarked == "",]
ggplot(full[full$Embarked != "" & full$Pclass == "1",],aes(x=Embarked,y=Fare, fill=Embarked)) + geom_boxplot()+
theme(legend.position="none") + geom_hline(aes(yintercept=80), colour='yellow', linetype='dashed', lwd=2)
full[full$Embarked=="",]$Embarked <- "C"
train[train$Embarked=="",]$Embarked <- "C"
full[is.na(full$Fare),]
ggplot(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,], aes(x=Fare)) +
geom_density(color="darkblue", fill="lightblue",size=1)+ylab("Densidad")+xlab("Precio del pasaje") +
geom_vline(xintercept = median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare),color="red",size=1.1,linetype="dashed") +
geom_vline(xintercept = mean(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare),color="green",size=1.1,linetype="dashed") +
annotate(geom = "text", label = c("Mediana", "Media"), x = c(median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare), mean(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)), y = c(0.05, 0.05), angle = 90, vjust = 1)
fare_median <-  median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)
full[is.na(full$Fare),]$Fare <- fare_median
test[is.na(test$Fare),]$Fare <- fare_median
full_imp <- kNN(full,k=11,dist_var=c('Sex','Pclass','SibSp','Fare','Parch','Embarked'),variable='Age')
ggplot() +
geom_density(data=full_imp, aes(x=Age,color='Imputado') , size=1) +
geom_density(data=full, aes(x=Age, color = 'No imputado') ,size=1) +
geom_vline(xintercept = median(full$Age,na.rm = TRUE),color="blue",size=1.1,linetype="dashed") +
geom_vline(xintercept = median(full_imp$Age),color="red",size=1.1,linetype="dashed") +
ylab("Frecuencia") + xlab("Edad") + theme(legend.position = 'right') +
scale_color_manual("DataSet",values = c('Imputado' = 'red', 'No imputado' = 'blue'))
full$Age <- full_imp$Age
train$Age[match( full_imp$PassengerId, train$PassengerId)] <- full_imp$Age[match( full_imp$PassengerId, train$PassengerId)]
full$Age <- full_imp$Age
train <- merge(train, full_imp[c('PassengerId','Age')], by.x=c("PassengerId"), by.y=c("PassengerId"), all.x=TRUE)
train <- train[,-which(names(train) %in% c("Age.x","PassengerId.y"))]
train %>% rename(Age.y = Age, PassengerId.y = PassengerId)
#full$Age <- full_imp$Age
#train <- merge(train, full_imp[c('PassengerId','Age')], by.x=c("PassengerId"), by.y=c("PassengerId"), all.x=TRUE)
#train <- train[,-which(names(train) %in% c("Age.x","PassengerId.y"))]
train %>% rename( Age = Age.y, PassengerId = PassengerId.y )
train %>% rename( Age = Age.y, PassengerId = PassengerId.y )
head(train)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(corrplot)
library(faraway)
library(ggfortify)
library(ResourceSelection)
library(pROC)
library(grid)
library(colorspace)
library(Rcpp)
library(vctrs)
library(tidyverse)
library(VIM)
train <- read.table(file="train.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(train)
test <- read.table(file="test.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(test)
full <- rbind(test,train[-which(names(train) == "Survived")])
full[full$Embarked == "",]
ggplot(full[full$Embarked != "" & full$Pclass == "1",],aes(x=Embarked,y=Fare, fill=Embarked)) + geom_boxplot()+
theme(legend.position="none") + geom_hline(aes(yintercept=80), colour='yellow', linetype='dashed', lwd=2)
full[full$Embarked=="",]$Embarked <- "C"
train[train$Embarked=="",]$Embarked <- "C"
full[is.na(full$Fare),]
ggplot(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,], aes(x=Fare)) +
geom_density(color="darkblue", fill="lightblue",size=1)+ylab("Densidad")+xlab("Precio del pasaje") +
geom_vline(xintercept = median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare),color="red",size=1.1,linetype="dashed") +
geom_vline(xintercept = mean(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare),color="green",size=1.1,linetype="dashed") +
annotate(geom = "text", label = c("Mediana", "Media"), x = c(median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare), mean(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)), y = c(0.05, 0.05), angle = 90, vjust = 1)
fare_median <-  median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)
full[is.na(full$Fare),]$Fare <- fare_median
test[is.na(test$Fare),]$Fare <- fare_median
full_imp <- kNN(full,k=11,dist_var=c('Sex','Pclass','SibSp','Fare','Parch','Embarked'),variable='Age')
ggplot() +
geom_density(data=full_imp, aes(x=Age,color='Imputado') , size=1) +
geom_density(data=full, aes(x=Age, color = 'No imputado') ,size=1) +
geom_vline(xintercept = median(full$Age,na.rm = TRUE),color="blue",size=1.1,linetype="dashed") +
geom_vline(xintercept = median(full_imp$Age),color="red",size=1.1,linetype="dashed") +
ylab("Frecuencia") + xlab("Edad") + theme(legend.position = 'right') +
scale_color_manual("DataSet",values = c('Imputado' = 'red', 'No imputado' = 'blue'))
full$Age <- full_imp$Age
train <- merge(train, full_imp[c('PassengerId','Age')], by.x=c("PassengerId"), by.y=c("PassengerId"), all.x=TRUE)
train <- train[,-which(names(train) %in% c("Age.x","PassengerId.y"))]
train %>% rename( Age = Age.y, PassengerId = PassengerId.y )
head(train)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(corrplot)
library(faraway)
library(ggfortify)
library(ResourceSelection)
library(pROC)
library(grid)
library(colorspace)
library(Rcpp)
library(vctrs)
library(tidyverse)
library(VIM)
train <- read.table(file="train.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(train)
test <- read.table(file="test.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(test)
full <- rbind(test,train[-which(names(train) == "Survived")])
full[full$Embarked == "",]
ggplot(full[full$Embarked != "" & full$Pclass == "1",],aes(x=Embarked,y=Fare, fill=Embarked)) + geom_boxplot()+
theme(legend.position="none") + geom_hline(aes(yintercept=80), colour='yellow', linetype='dashed', lwd=2)
full[full$Embarked=="",]$Embarked <- "C"
train[train$Embarked=="",]$Embarked <- "C"
full[is.na(full$Fare),]
ggplot(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,], aes(x=Fare)) +
geom_density(color="darkblue", fill="lightblue",size=1)+ylab("Densidad")+xlab("Precio del pasaje") +
geom_vline(xintercept = median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare),color="red",size=1.1,linetype="dashed") +
geom_vline(xintercept = mean(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare),color="green",size=1.1,linetype="dashed") +
annotate(geom = "text", label = c("Mediana", "Media"), x = c(median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare), mean(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)), y = c(0.05, 0.05), angle = 90, vjust = 1)
fare_median <-  median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)
full[is.na(full$Fare),]$Fare <- fare_median
test[is.na(test$Fare),]$Fare <- fare_median
full_imp <- kNN(full,k=11,dist_var=c('Sex','Pclass','SibSp','Fare','Parch','Embarked'),variable='Age')
ggplot() +
geom_density(data=full_imp, aes(x=Age,color='Imputado') , size=1) +
geom_density(data=full, aes(x=Age, color = 'No imputado') ,size=1) +
geom_vline(xintercept = median(full$Age,na.rm = TRUE),color="blue",size=1.1,linetype="dashed") +
geom_vline(xintercept = median(full_imp$Age),color="red",size=1.1,linetype="dashed") +
ylab("Frecuencia") + xlab("Edad") + theme(legend.position = 'right') +
scale_color_manual("DataSet",values = c('Imputado' = 'red', 'No imputado' = 'blue'))
full$Age <- full_imp$Age
train <- merge(train, full_imp[c('PassengerId','Age')], by.x=c("PassengerId"), by.y=c("PassengerId"), all.x=TRUE)
train <- train[,-which(names(train) %in% c("Age.x","PassengerId.y"))]
train %>% rename( Age = Age.y )
test <- merge(test, full_imp[c('PassengerId','Age')], by.x=c("PassengerId"), by.y=c("PassengerId"), all.x=TRUE)
test <- test[,-which(names(test) %in% c("Age.x","PassengerId.y"))]
test %>% rename(Age = Age.y )
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(corrplot)
library(faraway)
library(ggfortify)
library(ResourceSelection)
library(pROC)
library(grid)
library(colorspace)
library(Rcpp)
library(vctrs)
library(tidyverse)
library(VIM)
train <- read.table(file="train.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(train)
test <- read.table(file="test.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(test)
full <- rbind(test,train[-which(names(train) == "Survived")])
full[full$Embarked == "",]
ggplot(full[full$Embarked != "" & full$Pclass == "1",],aes(x=Embarked,y=Fare, fill=Embarked)) + geom_boxplot()+
theme(legend.position="none") + geom_hline(aes(yintercept=80), colour='yellow', linetype='dashed', lwd=2)
full[full$Embarked=="",]$Embarked <- "C"
train[train$Embarked=="",]$Embarked <- "C"
full[is.na(full$Fare),]
ggplot(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,], aes(x=Fare)) +
geom_density(color="darkblue", fill="lightblue",size=1)+ylab("Densidad")+xlab("Precio del pasaje") +
geom_vline(xintercept = median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare),color="red",size=1.1,linetype="dashed") +
geom_vline(xintercept = mean(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare),color="green",size=1.1,linetype="dashed") +
annotate(geom = "text", label = c("Mediana", "Media"), x = c(median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare), mean(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)), y = c(0.05, 0.05), angle = 90, vjust = 1)
fare_median <-  median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)
full[is.na(full$Fare),]$Fare <- fare_median
test[is.na(test$Fare),]$Fare <- fare_median
full_imp <- kNN(full,k=11,dist_var=c('Sex','Pclass','SibSp','Fare','Parch','Embarked'),variable='Age')
ggplot() +
geom_density(data=full_imp, aes(x=Age,color='Imputado') , size=1) +
geom_density(data=full, aes(x=Age, color = 'No imputado') ,size=1) +
geom_vline(xintercept = median(full$Age,na.rm = TRUE),color="blue",size=1.1,linetype="dashed") +
geom_vline(xintercept = median(full_imp$Age),color="red",size=1.1,linetype="dashed") +
ylab("Frecuencia") + xlab("Edad") + theme(legend.position = 'right') +
scale_color_manual("DataSet",values = c('Imputado' = 'red', 'No imputado' = 'blue'))
full$Age <- full_imp$Age
train <- merge(train, full_imp[c('PassengerId','Age')], by.x=c("PassengerId"), by.y=c("PassengerId"), all.x=TRUE)
train <- train[,-which(names(train) %in% c("Age.x","PassengerId.y"))]
train %>% rename( Age = Age.y )
test <- merge(test, full_imp[c('PassengerId','Age')], by.x=c("PassengerId"), by.y=c("PassengerId"), all.x=TRUE)
test <- test[,-which(names(test) %in% c("Age.x","PassengerId.y"))]
rename(test,Age = Age.y )
full[full$Fare == 0,]
full[full$Ticket == '239853']
full[full$Ticket == '239853',]
knitr::opts_chunk$set(echo = TRUE)
median_fare_1 <- median(full[full$Fare != 0 & full$PClass == 1 & full$Embarked == 'S',]$Fare)
median_fare_2 <- median(full[full$Fare != 0 & full$PClass == 2 & full$Embarked == 'S',]$Fare)
median_fare_3 <- median(full[full$Fare != 0 & full$PClass == 3 & full$Embarked == 'S',]$Fare)
#Imputamos según la clase en los dataset que hemos generado:
full[full$Fare == 0 & full$PClass == 1,]$Fare <- median_fare_1
full[full$Fare == 0 & full$PClass == 1,]$Fare
full[full$Fare == 0,]
full[full$Fare == 0 & full$PClass != 1,]$Fare
full[full$Fare == 0 & full$PClass == 2,]$Fare
full[full$Fare == 0 ,]$Pclass
median_fare_!
median_fare_1
full[full$Fare != 0 & full$PClass == 1 & full$Embarked == 'S',]$Fare
full[!is.na(full$Fare) & full$Fare != 0 & full$PClass == 1 & full$Embarked == 'S',]$Fare
train <- read.table(file="train.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(train)
test <- read.table(file="test.csv",sep=',',dec='.',stringsAsFactors = TRUE,header=TRUE)
summary(test)
full <- rbind(test,train[-which(names(train) == "Survived")])
fare_median <-  median(full[!is.na(full$Fare) & full$Pclass == "3" & full$Embarked == "S" ,]$Fare)
full[is.na(full$Fare),]$Fare <- fare_median
test[is.na(test$Fare),]$Fare <- fare_median
median(full[!is.na(full$Fare) & full$Fare != 0 & full$PClass == 1 & full$Embarked == 'S',]$Fare)
median(full[full$Fare != 0 & full$PClass == 1 & full$Embarked == 'S',]$Fare)
full[full$Fare != 0 & full$PClass == 1 & full$Embarked == 'S',]$Fare
full[full$Fare != 0 & full$PClass == 1 & full$Embarked == 'S',]
full[full$Fare != 0 ,]$Fare
full[full$PClass == 1,]$Fare
full[full$Fare != 0 & full$Pclass == 1 & full$Embarked == 'S',]$Fare
median_fare_1 <- median(full[full$Fare != 0 & full$Pclass == 1 & full$Embarked == 'S',]$Fare)
median_fare_2 <- median(full[full$Fare != 0 & full$Pclass == 2 & full$Embarked == 'S',]$Fare)
median_fare_3 <- median(full[full$Fare != 0 & full$Pclass == 3 & full$Embarked == 'S',]$Fare)
#Imputamos según la clase en los dataset que hemos generado:
full[full$Fare == 0 & full$Pclass == 1,]$Fare <- median_fare_1
full[full$Fare == 0 & full$Pclass == 2,]$Fare <- median_fare_2
full[full$Fare == 0 & full$Pclass == 3,]$Fare <- median_fare_3
train[train$Fare == 0 & train$Pclass == 1,]$Fare <- median_fare_1
train[train$Fare == 0 & train$Pclass == 2,]$Fare <- median_fare_2
train[train$Fare == 0 & train$Pclass == 3,]$Fare <- median_fare_3
test[test$Fare == 0 & test$Pclass == 1,]$Fare <- median_fare_1
test[test$Fare == 0 & test$Pclass == 2,]$Fare <- median_fare_2
test[test$Fare == 0 & test$Pclass == 3,]$Fare <- median_fare_3
